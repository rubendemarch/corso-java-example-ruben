<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- QUESTO E' IL FILE CHE COMPONE LE QUERY -->
<mapper namespace="Users">
	<select id="lookfor" resultType="int" parameterType="struts2.LoginAction">
		select count(USER_NAME) from USERS
		WHERE PASSWORD=#{md5password} AND USER_NAME=#{userName}
	</select>
<!-- select count(USERNAME) from UTENTI
		WHERE PASSWORD='admin123' AND USERNAME='admin' -->
		<!-- select count(${colName}) from ${table}
		WHERE ${colPw}=#{getPassword()} and ${colName}=#{getUserName()} 
		controlla se utente e password sono nel db
		-->
	<select id="count" resultType="int" parameterType="struts2.RegisterAction">
		select count(USER_NAME) from USERS
		WHERE USER_NAME=#{userName}
	</select>
	<insert id="add" parameterType="struts2.RegisterAction">
		INSERT INTO USERS(ID_USER,USER_NAME,NAME,SURNAME,PASSWORD,
		E_MAIL,PHONE,MOBILE_PHONE,BIRTH_DAY,REGISTER_DAY,ID_ROLE)
		VALUES(#{idUser},#{userName},#{name},#{surname},#{md5password},#{email},#{phone,jdbcType=VARCHAR},#{mobilePhone,jdbcType=VARCHAR},#{birthDate,jdbcType=DATE},#{registerDate},#{idRole})
	</insert>
	<update id="login" parameterType="struts2.LoginAction">
		update USERS set LAST_LOGIN=#{lastLogin}
		WHERE USER_NAME=#{userName}
	</update>
</mapper>